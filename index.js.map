{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com';\n\nexport default async function getImagesByQuery(query, page = 1) {\n  return await axios\n    .get('/api/', {\n      params: {\n        key: '51813911-adef45491f9b881200172b027',\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page: page,\n        per_page: 15,\n      },\n    })\n    .then(res => {\n      return res.data;\n    })\n    .catch(function (error) {\n      console.log(error);\n    });\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst galleryElem = document.querySelector('.gallery');\nconst loaderElem = document.querySelector('.loader');\nconst loadBtnElem = document.querySelector('.js-load-bt');\n\nexport function createGallery(images) {\n  const markup = templatePictures(images);\n  galleryElem.insertAdjacentHTML('beforeend', markup);\n  gallery.refresh();\n}\n\nfunction templatePictures(posts) {\n  return posts.map(templatePicture).join('');\n}\n\nfunction templatePicture(\n  { likes, views, comments, downloads, largeImageURL, webformatURL, tags },\n  i\n) {\n  return `<li class=\"gallery-item\"><a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img class=\"image-item\" src=\"${webformatURL}\" alt=\"${tags}\" /></a>\n          <div class=\"text-item\">\n            <div class=\"single-text\">\n              <h5>Likes</h5>\n              <p>${likes}</p>\n            </div>\n            <div class=\"single-text\">\n              <h5>Views</h5>\n              <p>${views}</p>\n            </div>\n            <div class=\"single-text\">\n              <h5>Comments</h5>\n              <p>${comments}</p>\n            </div>\n            <div class=\"single-text\">\n              <h5>Downloads</h5>\n              <p>${downloads}</p>\n            </div>\n          </div>\n        </li>`;\n}\nlet gallery = new SimpleLightbox('.gallery-link', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function clearGallery() {\n  galleryElem.innerHTML = '';\n}\n\nexport function showLoader() {\n  loaderElem.style.display = 'flex';\n}\n\nexport function hideLoader() {\n  loaderElem.style.display = 'none';\n}\nexport function showLoadMoreButton() {\n  loadBtnElem.classList.remove('hide');\n}\nexport function hideLoadMoreButton() {\n  loadBtnElem.classList.add('hide');\n}\n","import getImagesByQuery from './js/pixabay-api.js';\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n} from './js/render-functions.js';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst formElem = document.querySelector('.js-form');\nconst loadBtnElem = document.querySelector('.js-load-bt');\n\nlet page = 1;\nlet searchText = '';\nlet totalPages = 0;\n\ndocument.addEventListener('DOMContentLoaded', e => {\n  hideLoader();\n  hideLoadMoreButton();\n});\n\nformElem.addEventListener('submit', async e => {\n  e.preventDefault();\n  page = 1;\n  hideLoadMoreButton();\n  if (e.currentTarget.elements['search-text'].value.trim() == '') {\n    return;\n  }\n  searchText = e.currentTarget.elements['search-text'].value.trim();\n  e.currentTarget.elements['search-text'].value = '';\n  clearGallery();\n  showLoader();\n  try {\n    const images = await getImagesByQuery(searchText);\n    if (images.hits.length != 0) {\n      totalPages = Math.ceil(images.totalHits / 15);\n      createGallery(images.hits);\n      hideLoader();\n      const galleryCard = document.querySelector('.gallery-item');\n      if (galleryCard) {\n        const { height: cardHeight } = galleryCard.getBoundingClientRect();\n        window.scrollBy({\n          top: cardHeight * 2,\n          behavior: 'smooth',\n        });\n      }\n      if (totalPages < 2) {\n        iziToast.info({\n          title: 'Message',\n          message: 'We`re sorry, but you`ve reached the end of search results.',\n        });\n      } else {\n        showLoadMoreButton();\n      }\n    } else {\n      iziToast.error({\n        title: 'Error',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n      hideLoader();\n    }\n  } catch (error) {\n    hideLoader();\n    iziToast.error({\n      title: 'Error',\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n    });\n    console.log(error);\n  }\n});\n\nloadBtnElem.addEventListener('click', async e => {\n  page += 1;\n  showLoader();\n  try {\n    const images = await getImagesByQuery(searchText, page);\n    if (images.hits.length != 0) {\n      createGallery(images.hits);\n      hideLoader();\n      const galleryCard = document.querySelector('.gallery-item');\n      if (galleryCard) {\n        const { height: cardHeight } = galleryCard.getBoundingClientRect();\n        window.scrollBy({\n          top: cardHeight * 2,\n          behavior: 'smooth',\n        });\n      }\n      if (totalPages < page + 1) {\n        hideLoadMoreButton();\n        iziToast.info({\n          title: 'Message',\n          message: 'We`re sorry, but you`ve reached the end of search results.',\n        });\n      }\n    } else {\n      iziToast.error({\n        title: 'Error',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n      hideLoadMoreButton();\n      hideLoader();\n    }\n  } catch (error) {\n    hideLoader();\n    hideLoadMoreButton();\n    iziToast.error({\n      title: 'Error',\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n    });\n    console.log(error);\n  }\n});\n"],"names":["axios","getImagesByQuery","query","page","res","error","galleryElem","loaderElem","loadBtnElem","createGallery","images","markup","templatePictures","gallery","posts","templatePicture","likes","views","comments","downloads","largeImageURL","webformatURL","tags","i","SimpleLightbox","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","formElem","searchText","totalPages","e","galleryCard","cardHeight","iziToast"],"mappings":"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"}